<div id='albums' class='albums section scrollspy'>
  <h2>Photo Albums</h2>
  <div id='photos_go_here' class='row'>
  </div>
</div>

<script>
  var album = <%=raw @album.to_json %>

  $.ajax({
    method: 'get',
    url:"https://api.flickr.com/services/rest/?&method=flickr.photosets.getPhotos&api_key=<%=ENV['FLICKR_KEY']%>&photoset_id="+album.photoset_id+"&format=json",
    dataType: 'jsonp'
  });

  function jsonFlickrApi(rsp){
    stuff = rsp
  	if (rsp.stat != "ok"){
  		return;
  	}
  	for (var i=0; i<rsp.photoset.photo.length; i++){
      outer_div = document.createElement('div');
      outer_div.className='col l3 m6 s12 hoverable card';
      photo_holder = document.getElementById('photos_go_here');
      var slider = document.createElement('div');
      slider.className='slider card-image';
      outer_div.appendChild(slider);
      var title = document.createElement('div');
      var titleText = document.createElement('h6')
      titleText.innerHTML = rsp.photoset.photo[i].title;
      title.className = 'card-content';
      title.appendChild(titleText);
      outer_div.appendChild(title);
      var slides = document.createElement('ul')
      slides.className='slides materialboxed';
      slides.style.backgroundColor = '';
      slides.setAttribute("data-caption", rsp.photoset.photo[i].title);
      slider.appendChild(slides);
      photo_holder.appendChild(outer_div);
  		var photo = rsp.photoset.photo[i];
  		var li = document.createElement('li');
      var img_src = "http://farm" + photo.farm + ".static.flickr.com/" + photo.server + "/" + photo.id + "_" + photo.secret + "_" + "b.jpg";
      var img = document.createElement('img')
      img.src=img_src;
      li.appendChild(img)
  		slides.appendChild(li);
  	}
    $('.slider').slider({interval: false, indicators: false});
    $('.materialboxed').materialbox();
  }
</script>
